<!DOCTYPE html>
<html lang="he" dir="rtl" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8" />
    <title>Word Run</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.3.0/pure-min.css" />
    <link type="text/css" rel="stylesheet" href="css/modal.css" />
    <link type="text/css" rel="stylesheet" href="css/tabs.css" />
    <link type="text/css" rel="stylesheet" href="css/index.css" />
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.9/require.min.js" data-main="js/init"></script>
</head>
<body>
    <div id="chatApp" class="pure-g"></div>

    <script id="chatAppTemplate" type="text/html">
        <div class="modal-background pure-u">
            <div class="modal">
                <form class="pure-form pure-form-aligned">
                    <fieldset>
                        <legend>פרטי משתמש</legend>
                        <div class="pure-control-group">
                            <label for="name">כינוי</label>
                            <input id="name" type="text" placeholder="הכנס כינוי..." value="{{currentUser.name}}" />
                        </div>

                        <div class="pure-control-group">
                            <label for="age">גיל</label>
                            <select id="age" class="form-control" value='{{currentUser.age}}'>
                                <option >-גיל-</option>
                                {{#getValidAges()}}
                                <option value="{{(.)}}">{{(.)}}</option>
                                {{/getValidAges()}}
                            </select>
                        </div>

                        <div class="pure-control-group">
                            <label>מין</label>
                            <label for="genderMale" class="pure-radio">
                                <input id="genderMale" type="radio" name="{{currentUser.gender}}" value="male" />
                                זכר
                            </label>

                            <label for="genderFemale" class="pure-radio">
                                <input id="genderFemale" type="radio" name="{{currentUser.gender}}" value="female" />
                                נקבה
                            </label>
                        </div>

                        <div class="pure-controls">
                            <label for="saveUserInfo" class="pure-checkbox">
                                <input id="saveUserInfo" type="checkbox" checked="{{currentUser.saveUserInfo}}" />שמור את פרטי המשתמש</label>

                            <button id="submitLoginInfo" class="pure-button pure-button-primary" on-tap="login">היכנס לצ'אט</button>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>

        <div id="users" class="pure-u-1-6 side-list">
            <h4>משתמשים</h4>
            <ul>
                {{#users}}
                <li on-tap="openUserConversation:{{name}}">{{name}}</li>
                {{/users}}
            </ul>
        </div>
        <div class="pure-u-2-3">
            <div class="tabs">
                <ul>
                    {{#roomConversation}}
                    <li class="tab-title {{ selectedConversation === (.) ? 'selected-tab' : '' }}"
                        on-tap="showRoomConversation">
                        <span class="tab-name">{{room.name}}</span>
                    </li>
                    {{/roomConversation}}

                    {{#userConversations:name}}
                    {{#activeConversation}}
                    <li class="tab-title {{ selectedConversation === (.) ? 'selected-tab' : '' }}"
                        on-tap="openUserConversation:{{name}}">
                        <span on-tap="closeUserConversation:{{name}}">X</span>
                        <span class="tab-name">{{user.name}}</span>
                    </li>
                    {{/activeConversation}}
                    {{/userConversations}}
                </ul>
                <div class="tab-view">
                    {{#roomConversation}}
                    <div class="tab-content {{ selectedConversation === (.) ? 'selected-tab' : '' }}">
                        {{#messages}}
                          {{>message}}
                        {{/messages}}
                    </div>
                    {{/roomConversation}}

                    {{#userConversations:name}}
                    {{#activeConversation}}
                    <div class="tab-content {{ selectedConversation === (.) ? 'selected-tab' : '' }}">
                        {{#messages}}
                          {{>message}}
                        {{/messages}}
                    </div>
                    {{/activeConversation}}
                    {{/userConversations}}
                </div>
            </div>
            <form id="chatControls" class="pure-form">
                <input class="pure-input-1-2" id="textToSend" type="text" on-enter="sendMessage" autocomplete="off" />
                <button class="pure-button pure-button-primary" on-tap="sendMessage">שלח</button>
            </form>
        </div>
        <div id="rooms" class="pure-u-1-6 side-list">
            <h4>חדרים</h4>
            <ul>
                {{#rooms}}
                <li on-tap="showRoomConversation:{{name}}">{{name}}</li>
                {{/rooms}}
            </ul>
        </div>
        <!-- {{>message}} -->
        <div class="message">
            <span class="msg-time">{{time}}</span>
            <span class="msg-user-name" on-tap="openUserConversation:{{userName}}">{{userName}}:</span>
            <span class="msg-text">{{text}}</span>
        </div>
        <!-- {{/message}} -->
    </script>
</body>
</html>
